---
title: 如何使用grep查找某文件夹下所有.py文件中的指定字符串
toc: true
date: 2016-06-13 21:15:26
tags:
- linux
- wiki
---

## grep的基本使用
`grep`命令可以使用正则表达式来搜索文件中的特定字符串，而且需要搜索多个文件或者一类文件的时候可以模糊匹配文件名。例如使用`*.py`可以匹配所有_.py_结尾的文件。

但是`grep`模糊匹配文件名只能找当前目录下的文件，不能找到其子目录下的文件。例如命令`grep "xxx" *.py`，如果当前文件夹下有一个`abc.py`，子目录`sub`中有一个文件`efg.py`（相对路径是`sub/efg.py`）那么grep命令只会搜索`abc.py`中的字符串。

如果想要搜索当前文件夹及其子文件夹中的所有文件，那么有两种方法可以实现，分别为[使用grep命令的-R选项](#使用grep命令的-R选项)和[使用find命令实现](#使用find命令实现)。

## 使用grep命令的-R选项

在`grep`命令中，`-R`选项能指定grep搜索文件夹，并使用`--include`选项指定模糊匹配的文件名，多个文件名可以使用多个`--include`来实现。例如下面命令实现了搜索当前目录下所有.py和.json文件中的数字串：

```shell
egrep -R --include="*.py" --include="*.json" "[[:digit:]]+" .
```

## 使用find命令实现

find命令用于查找文件，查找的结果可以使用`-exec`选项传递给后续的命令，在后续命令中可以使用`{}`代替find的查找结果。如下命令实现与上文相同的功能：

```shell
# `-type f`为指定find返回结果类型是文件;
# `-or`链接不同的文件名匹配条件
# `-exec`选项以" \;"结尾。
find . -name "*.py" -or -name "*.json" -type f -exec egrep "[[:digit:]]+" {} \;
```

## 比较

使用grep中的-R选项似乎更直观方便一些，而且输出结果是带文件路径的，更加全面。